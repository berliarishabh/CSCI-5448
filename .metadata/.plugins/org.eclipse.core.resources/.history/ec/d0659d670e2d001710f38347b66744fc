package MRS.controllers;

import MRS.Common.DBProxy;
//import java.util.List;
//
//import MRS.Model.*;
import MRS.Model.User;

//import javax.validation.OverridesAttribute.List;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
//import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class LoginController {
	private DBProxy dbProxy;
	private PageController pc = null;
	
	private LoginController()
	{
		dbProxy = new DBProxy();
	}
	
	@PostMapping("/login")
	public String login(Model model, @RequestParam String name,
			@RequestParam String password)
	{
		Boolean result = false;
		System.out.println("in login function");
		result= dbProxy.validateUser(name, password);
		model.addAttribute("firstName", name);
		String retVal = "";
		if(result == true)
		{
			User user = dbProxy.getUserDetails(name, password);
			System.out.println("Name of user is " + user.getName());
			pc = new PageController(user);
			retVal = "welcomeMessage";	// name of the jsp file
		}
		else
		{
			retVal = "movies";
		}
		return retVal;
	}
}
