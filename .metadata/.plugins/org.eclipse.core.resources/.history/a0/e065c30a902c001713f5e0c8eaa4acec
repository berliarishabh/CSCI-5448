package MRS.controllers;

import MRS.Common.DBProxy;
import java.util.List;

import MRS.Model.*;

//import javax.validation.OverridesAttribute.List;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class WelcomeController
{
	private DBProxy dbProxy;
	
	private WelcomeController()
	{
		dbProxy = new DBProxy();
	}
	
	@GetMapping("/welcome")
	public String welcome(Model model, @RequestParam String name,
			@RequestParam String password)
	{
		System.out.println("abcd");
		Boolean result = false;
		result= dbProxy.validateUser(name, password);
		if(result == true)
		{
			model.addAttribute("firstName", name);
			return "welcomeMessage";	// name of the jsp file
		}
		else
		{
			return "movies";
		}
	}
	
	@GetMapping("/user")
	public String user(Model model)
	{
		List<User> ls;
		ls = dbProxy.getUserDetails("ribe3261", "Huddar");
		String result = ls.get(0).getName();
		model.addAttribute("firstName", result);
		return "welcomeMessage";	// name of the jsp file
	}
	
	@GetMapping("/movie")
	public String movie(Model model)
	{
		List<Movie> mv;
		mv = dbProxy.getMovies("", 0, 0, 'A');
		model.addAttribute("movieName", mv.get(1).getMovieName());
		model.addAttribute("releaseYear", mv.get(0).getReleaseYear());
		return "movies";	// name of the jsp file
	}
}
